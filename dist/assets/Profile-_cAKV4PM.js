import{p as o,j as e,ax as k,r,ap as M,aq as y,ar as $,at as x,ak as b,a9 as T,aa as v,ag as V,au as S,av as f}from"./index-VMf9MKGU.js";const z=o(e.jsx("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday"),F=o([e.jsx("path",{d:"M15.11 12.45 14 10.24l-3.11 6.21c-.16.34-.51.55-.89.55s-.73-.21-.89-.55L7.38 13H2v5c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-5h-6c-.38 0-.73-.21-.89-.55"},"0"),e.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v5h6c.38 0 .73.21.89.55L10 13.76l3.11-6.21c.34-.68 1.45-.68 1.79 0L16.62 11H22V6c0-1.1-.9-2-2-2"},"1")],"MonitorHeart"),E=o(e.jsx("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PermIdentity"),R=o(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),O=o(e.jsx("path",{d:"M5 4v2h14V4zm0 10h4v6h6v-6h4l-7-7z"}),"Publish");function J({canEdit:C}){var w;const{id:j}=k(),[l,N]=r.useState(null),[I,W]=r.useState(localStorage.getItem("userID")||null),L=async()=>{d(!0);try{const a=new FormData;a.append("name",s==null?void 0:s.name),l&&(a.append("profileImg",l),a.append("imgLink",s!=null&&s.profileImg?s.profileImg:s==null?void 0:s.imgLink)),n!=null&&n.isAdmin&&(a.append("isAdmin",s==null?void 0:s.isAdmin),a.append("isActive",s==null?void 0:s.isActive));const t=y.get("accessToken"),{data:c}=await S.put(`${x}/user/update/${j}`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+t}}),{status:p,res:g}=c;if(p===400){d(!1);const{error:{errorList:i}}=g;A(i)}else{if(d(!1),p==200){const{success:{msg:i}}=g;f.success(i)}else{const{error:{msg:i}}=g;f.error(i)}N(null),A({name:void 0,profileImg:void 0})}}catch(a){f.error(a.message),d(!1)}},[u,d]=r.useState(!1),[m,A]=r.useState({name:void 0,profileImg:void 0}),n=JSON.parse(localStorage.getItem("usersData"))||null,B=M(),[s,h]=r.useState(null),H=()=>{B("/")},U=y.get("accessToken"),P=async()=>{if(!I||!n||(n==null?void 0:n._id)!==I||!U){H();return}if(s===null){const{data:a}=await S.get(`${x}/user/${j}`,{headers:{Authorization:"Bearer "+U}}),{status:t,res:c}=a;if(t==200){const{success:{dataList:p}}=c;h(p)}}};return r.useEffect(()=>{P()},[]),e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsxs("div",{className:"update",children:[e.jsx("div",{className:"userTitleContainer",children:e.jsx("h1",{className:"userTitle",children:C?"Edit User":(s==null?void 0:s.name)+" Profile"})}),e.jsxs("div",{className:"usercontainer",children:[e.jsxs("div",{className:"userShow",children:[e.jsxs("div",{className:"uperShowTops",children:[e.jsx("img",{src:s?`${x}/image/${s!=null&&s.profileImg?s.profileImg:s==null?void 0:s.imgLink}`:"/user.jpg",alt:"",className:"usershwoimg"}),e.jsxs("div",{className:"usershowToptitle",children:[e.jsx("span",{className:"usershowNamse",children:s==null?void 0:s.name}),e.jsx("span",{className:"usershowTitles",children:s==null?void 0:s.email})]})]}),e.jsxs("div",{className:"uperShowBottoms",children:[e.jsx("span",{className:"usershowinfoTitle",children:"Account Details"}),e.jsxs("div",{className:"usershowInfoContainer",children:[e.jsx(E,{className:"UserShowButtonIcon"}),e.jsx("span",{className:"usershowinfoTitlssae",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"usershowInfoContainer",children:[e.jsx(z,{className:"UserShowButtonIcon"}),e.jsx("span",{className:"usershowinfoTitlssae",children:(w=s==null?void 0:s.createdAt)==null?void 0:w.split("-")[0]})]}),e.jsx("span",{className:"usershowinfoTitle",children:"Personal Details"}),e.jsxs("div",{className:"usershowInfoContainer",children:[e.jsx(R,{className:"UserShowButtonIcon"}),e.jsx("span",{className:"usershowinfoTitlssae",children:s!=null&&s.isAdmin?"Admin":"normal user"})]}),e.jsxs("div",{className:"usershowInfoContainer",children:[e.jsx(F,{className:"UserShowButtonIcon"}),e.jsx("span",{className:"usershowinfoTitlssae",children:s!=null&&s.isActive?"Active":"Not Active"})]})]})]}),e.jsxs("div",{className:"userUpdate",children:[e.jsx("span",{className:"userUpdatetitle",children:"Edit"}),e.jsxs("div",{className:"userUpdateForm",children:[e.jsxs("div",{className:"userUpdateLeft",children:[e.jsxs("div",{className:"userUpdateItem",children:[e.jsx("p",{style:{marginBottom:"3px"},children:"Change Name"}),e.jsx(b,{name:"user",value:s==null?void 0:s.name,onChange:a=>{h(t=>({...t,name:a.target.value}))}}),m.name&&e.jsx("span",{className:"error",children:m.name})]}),(n==null?void 0:n.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"userUpdateItem",style:{marginTop:"10px"},children:[e.jsx("p",{style:{marginBottom:"3px"},children:"Change user Account"}),e.jsxs(T,{fullWidth:!0,value:s!=null&&s.isAdmin?"Admin":"User",onChange:a=>{let t=a.target.value==="Admin";localStorage.getItem("userID")!==j&&h(c=>({...c,isAdmin:t}))},children:[e.jsx(v,{value:"User",children:"User"}),e.jsx(v,{value:"Admin",children:"Admin"})]})]}),e.jsxs("div",{className:"userUpdateItem",style:{marginTop:"10px"},children:[e.jsx("p",{style:{marginBottom:"3px"},children:"Change user Status"}),e.jsxs(T,{value:s!=null&&s.isActive?"Active":"InActive",onChange:a=>{let t=a.target.value==="Active";h(c=>({...c,isActive:t}))},fullWidth:!0,children:[e.jsx(v,{value:"Active",children:"Active"}),e.jsx(v,{value:"InActive",children:"InActive"})]})]})]})]}),e.jsxs("div",{className:"userUpdateRight",children:[e.jsxs("div",{className:"userUpdateUpload",children:[e.jsx("img",{src:l?URL.createObjectURL(l):s?`${x}/image/${s!=null&&s.profileImg?s.profileImg:s==null?void 0:s.imgLink}`:"/user.jpg",className:"UserUpdateImg",alt:""}),e.jsx("label",{htmlFor:"file",children:e.jsx(O,{className:"userUpdateIconss"})}),e.jsx("input",{type:"file",onChange:a=>{N(a.target.files[0])},style:{display:"none"},name:"file",id:"file"})]}),m.profileImg&&e.jsx("span",{className:"error",children:m.profileImg}),e.jsx("button",{disabled:u,style:{cursor:u?"not-allowed":"pointer"},onClick:L,className:"userUpdateButton",children:u?e.jsx(V,{size:"1.3rem",color:"primary"}):"Update"})]})]})]})]})]}),";"]})}export{J as default};
